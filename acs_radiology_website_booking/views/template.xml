<odoo>

    <template id="acs_radiology_requests" inherit_id="acs_radiology.radiology_requests" name="Radiology Requests">
        <xpath expr="//th[@name='th_state']" position="after">
            <th></th>
        </xpath>
        <xpath expr="//td[@name='td_state']" position="after">
            <td>
                <a t-if="radiology_req.invoice_id and radiology_req.invoice_id.payment_state in ['not_paid']" class="btn btn-primary" title="Pay Now" t-att-href="'/my/invoices/'+str(radiology_req.invoice_id.id)+'#portal_pay'">Pay Now</a>
            </td>
        </xpath>
    </template>

    <template id="radiology_req_progress_checkout" name="Radiology Test Request Checkout">
        <div class="row">
            <t t-set="cancel_warning">'Are you sure you want to cancel process?'</t>
            <t t-set="radiology_request" t-value="website.acs_get_request('acs.radiology.request')"/>
            <div class="col-xl">
                <div class="wizard">
                    <span t-if="payment_step" class="o_wizard_has_extra_step d-none"/>
                    <div class="progress-wizard">
                        <a class="no-decoration" t-att-href="step&gt;=10 and '/create/radiology/appointment' or '#'">
                            <div id="wizard-step10" t-att-class="'acs-progress-step progress-wizard-step %s' % (step == 10 and 'active' or step&gt;10 and 'complete' or 'disabled')">
                                <div class="progress-wizard-bar d-none d-md-block"/>
                                <span class="progress-wizard-dot d-none d-md-inline-block"></span>
                                <div class="text-center progress-wizard-steplabel">Radiology Room</div>
                            </div>
                        </a>
                        
                        <a class="no-decoration" t-att-href="step&gt;=20 and '/acs/radiology/slot' or '#'">
                            <div id="wizard-step20" t-att-class="'acs-progress-step progress-wizard-step %s' % (step == 20 and 'active' or step&gt;20 and 'complete' or 'disabled')">
                                <div class="progress-wizard-bar d-none d-md-block"/>
                                <span class="progress-wizard-dot d-none d-md-inline-block"></span>
                                <div class="text-center progress-wizard-steplabel">Select Slot</div>
                            </div>
                        </a>

                        <a class="no-decoration" t-att-href="step&gt;=30 and '/acs/radiology/tests' or '#'">
                            <div id="wizard-step30" t-att-class="'acs-progress-step progress-wizard-step %s' % (step == 30 and 'active' or step&gt;30 and 'complete' or 'disabled')">
                                <div class="progress-wizard-bar d-none d-md-block"/>
                                <span class="progress-wizard-dot d-none d-md-inline-block"></span>
                                <div class="text-center progress-wizard-steplabel">Radiology Tests</div>
                            </div>
                        </a>

                        <a class="no-decoration" t-att-href="step&gt;=40 and '/acs/radiology/patients' or '#'">
                            <div id="wizard-step40" t-att-class="'acs-progress-step progress-wizard-step %s' % (step == 40 and 'active' or step&gt;40 and 'complete' or 'disabled')">
                                <div class="progress-wizard-bar d-none d-md-block"/>
                                <span class="progress-wizard-dot d-none d-md-inline-block"></span>
                                <div class="text-center progress-wizard-steplabel">Patient Data</div>
                            </div>
                        </a>

                        <a class="no-decoration" t-att-href="'#'" t-if="payment_step">
                            <div id="wizard-step50" t-att-class="'acs-progress-step progress-wizard-step %s' % (step == 50 and 'active' or step&gt;50 and 'complete' or 'disabled')">
                                <div class="progress-wizard-bar d-none d-md-block"/>
                                <span class="progress-wizard-dot d-none d-md-inline-block"></span>
                                <div class="text-center progress-wizard-steplabel">Payment</div>
                            </div>
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div t-if="message" class="col-12 alert alert-success alert-dismissable d-print-none" role="status">
                <button type="button" class="close" data-dismiss="alert" aria-label="Close">&amp;times;</button>
                <strong>
                    <span t-esc="message"/>
                </strong>
            </div>
            <div t-if="error_message" class="col-12 alert alert-danger alert-dismissable d-print-none" role="status">
                <button type="button" class="close" data-dismiss="alert" aria-label="Close">&amp;times;</button>
                <strong>
                    <span t-esc="error_message"/>
                </strong>
            </div>
        </div> 
    </template>
 
    <template id="acs_location_card" name="Branch Card">
        <div class="card card-default acs_location_card col-md-2 col-xs-6 acs_radio_block" style="padding:10px;">
            <input type="radio" name="radiology_room_id" class="acs_checkbox sr-only" t-att-value="acs_location.id" t-attf-id="acs_location{{acs_location.id}}" t-att-checked="'checked' if acs_location.id==radiology_room_id else None" required=""/>
            <label t-attf-for="acs_location{{acs_location.id}}" style="width: 100%;">
                <div>
                    <img t-if="acs_location.image_1920" class="acs_location_image" t-attf-src="data:image/png;base64,{{acs_location.image_1920}}" alt="Room"/>
                    <img t-else="" class="acs_location_image" src="/acs_radiology_website_booking/static/description/acs_location.png" alt="Room"/>
                    <div class="acs_location_name">
                        <strong><span t-esc="acs_location.name"/></strong>
                    </div>
                </div>
            </label>
        </div>
    </template>

    <template id="radiology_appointment_patient_and_location" name="Select Patient Count &amp; Location">
        <t t-call="website.layout">
            <div id="wrap">
                <div class="container oe_website_sale py-2">
                    <div class="row">
                        <t t-set="cancel_warning">'Are you sure you want to cancel process?'</t>
                        <div class="col-12">
                            <t t-call="acs_radiology_website_booking.radiology_req_progress_checkout">
                                <t t-set="step" t-value="10"/>
                            </t>
                        </div>
                        <form action="/acs/radiology/slot" method="post" role="form" class="tag_text js_website_submit_form" enctype="multipart/form-data">
                            <div class="row justify-content-md-center" t-if="radiology_request">

                                <div class="row text-center acs_location_selection mt16">
                                    <t t-foreach="locations" t-as="location">
                                        <t t-call="acs_radiology_website_booking.acs_location_card">
                                            <t t-set="acs_location" t-value="location"/>
                                        </t>
                                    </t>
                                </div>

                            </div>

                            <div class="row justify-content-md-center mt64" t-if="not radiology_request">
                                <a class="btn btn-default btn-primary mb32" t-if="request.website.is_public_user()" href="/web/login?redirect=/create/radiology/appointment" help="Click here to login."> Login to book an Appointment.</a>

                                <div t-if="not request.website.is_public_user()">
                                    There is no Linked Patient with your Login. Please Contact Administartor.
                                </div>
                            </div>

                            <div class="row" t-if="radiology_request">
                                <div class="col-12 clearfix text-center mt32 mb32">
                                    <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
                                    <button type="submit" class="btn btn-default btn-primary mb32 "> Next <span class="fa fa-long-arrow-right" />
                                    </button>
                                    <a t-attf-onclick="return confirm(#{cancel_warning});" t-attf-href="/" class="btn btn-default mb32">Cancel</a>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </t>
    </template>

    <template id="radiology_appointment_slot" name="Select Slot">
        <t t-call="website.layout">
            <div id="wrap">
                <div class="container oe_website_sale py-2">
                    <div class="row">
                        <t t-set="cancel_warning">'Are you sure you want to cancel process?'</t>
                        <div class="col-12">
                            <t t-call="acs_radiology_website_booking.radiology_req_progress_checkout">
                                <t t-set="step" t-value="20"/>
                            </t>
                        </div>
                        
                        <div class="col-12 mt32">
                            <form action="/acs/radiology/tests" method="post" role="form" class="js_website_submit_form" enctype="multipart/form-data">
                                <input type="hidden" name="slot_date" id="acs_slot_date"/>
                                <input type="hidden" name="schedule_slot_id" id="acs_schedule_slot_id"/>
                                <input type="hidden" name="last_date" t-att-value="last_date"/>
                                <input type="hidden" name="disable_dates" t-att-value="disable_dates"/>
                                <t t-if="not slots_data">
                                    <div class="col-12 alert alert-danger">
                                        <span>There are no slots available to book appointment please check later or contact with Management.</span>
                                    </div>
                                </t>

                                <t t-if="slots_data">
                                    <div class="row">
                                        <div class="col-md-4">
                                            <div id="ACSBookingDatePicker"></div>
                                        </div>
                                        <div class="col-md-8">
                                            <div class="row">
                                                <div class="acs_no_slots col-md-12 alert alert-danger text-center">
                                                    <span>No slots available for selected date.</span>
                                                </div>
                                                <t t-foreach="slots_data" t-as="slot">
                                                    <div class="acs_booking_slot btn btn-default btn-secondary mb32 col-md-2 col-xs-6" t-att-id="slot['id']" t-att-data-slotline-id="slot['id']" t-att-data-date="slot['date']" style="display:none;">
                                                        <span t-esc="slot['name']"/>
                                                        <t t-if="department and slot['physician_name']">
                                                            <span class="acs_small_font" t-esc="slot['physician_name']"/>
                                                        </t>
                                                        <div t-if="slot['show_fees']">
                                                            <span class="acs_small_font">Fees: <t t-esc="slot['fees']"/></span>
                                                        </div>
                                                    </div>
                                                </t>
                                            </div>
                                        </div>
                                    </div>
                                </t>
                                <div class="row">
                                    <div class="col-12 clearfix text-center mt32 mb32">
                                        <a class="btn btn-default btn-primary mb32" t-if="request.website.is_public_user()" href="/web/login?redirect=/create/radiology/appointment" help="Click here to login."> Login to book an Appointment.</a>
                                        <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
                                        <button type="submit" t-if="not request.website.is_public_user() and slots_data"  class="btn btn-default btn-primary mb32 "> Next <span class="fa fa-long-arrow-right" />
                                        </button>
                                        <a t-attf-onclick="return confirm(#{cancel_warning});" t-attf-href="/" class="btn btn-default mb32">Cancel</a>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </t>
    </template>

    <template id="acs_radiology_test_card" name="Radiology Tests Card">
        <div class="card card-default radiology_test_card acs_record_block acs_record_panel col-md-2 col-xs-6 acs_radio_block " style="padding:10px;width: 200px;">
            <input type="radio" name="radiology_test_id" class="acs_checkbox sr-only" t-att-value="radiology_test.id" t-attf-id="radiology_test{{radiology_test.id}}" t-att-checked="'checked' if radiology_test.id in radiology_request.line_ids.mapped('test_id').ids else None"/>
            <label t-attf-for="radiology_test{{radiology_test.id}}" style="width: 100%;">
                <div>
                    <img t-if="radiology_test.image_1920" class="acs_service_image" t-attf-src="data:image/png;base64,{{radiology_test.image_1920}}" alt="Test" style="height:130px;"/>
                    <img t-else="" class="acs_service_image" src="/acs_radiology_website_booking/static/description/acs_service.png" alt="Test" style="height:130px;"/>
                    <div t-if="radiology_test.name" class="acs_radiology_test_name acs_record_name">
                        <span t-field="radiology_test.display_name"/>
                    </div>
                    <div t-if="radiology_request.schedule_slot_id.acs_schedule_id.show_fee_on_booking" class="radiology_test_price">
                        <span t-esc="radiology_test.product_id.lst_price" t-options="{'widget': 'monetary', 'display_currency': currency_id}"/><br/>
                    </div>
                </div>
            </label>
        </div>
    </template>

    <template id="radiology_appointment_tests" name="Select Test">
        <t t-call="website.layout">
            <div id="wrap">
                <div class="container oe_website_sale py-2">
                    <div class="row">
                        <t t-set="cancel_warning">'Are you sure you want to cancel process?'</t>
                        <div class="col-12">
                            <t t-call="acs_radiology_website_booking.radiology_req_progress_checkout">
                                <t t-set="step" t-value="30"/>
                            </t>
                        </div>
                        
                        <form action="/acs/radiology/patients" method="post" role="form" class="js_website_submit_form" enctype="multipart/form-data">
                            <div class="row" id="acs_test_datas">
                                <div class="text-center col-12 mt32 mb32">
                                    <input type="text" placeholder="Search Test..." id="AcsRecordSearch" name="acs_tests_search" t-if="radiology_tests" class="form-control text-center col-4"/>
                                </div>
                            </div>
                            <div class="row text-center acs_location_selection mt16" t-if="radiology_tests">   
                                <t t-set="display_image" t-value="any(lt.image_1920 for lt in radiology_tests)"/>
                                <t t-foreach="radiology_tests" t-as="radiology_test">
                                    <t t-call="acs_radiology_website_booking.acs_radiology_test_card"/>
                                </t>
                            </div>

                            <div class="row">
                                <div class="col-12 clearfix text-center mt32 mb32">
                                    <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
                                    <button type="submit" class="btn btn-default btn-primary mb32 "> Next <span class="fa fa-long-arrow-right" />
                                    </button>
                                    <a t-attf-onclick="return confirm(#{cancel_warning});"  t-attf-href="/" class="btn btn-default mb32">Cancel</a>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </t>
    </template>
 
    <template id="acs_patient_card" name="Patient Card">
        <div class="card card-default radiology_test_card col-md-2 col-xs-6 acs_radio_block" style="padding:10px;width:200px;">
            <input type="radio" name="acs_patient_id" class="acs_checkbox sr-only" t-att-value="acs_patient.id" t-attf-id="acs_patient{{acs_patient.id}}" t-att-checked="'checked' if acs_patient.id==patient.id else None"/>
            <label t-attf-for="acs_patient{{acs_patient.id}}" style="width: 100%;">
                <div>
                    <img t-if="acs_patient.image_1920" class="acs_patient_image" t-attf-src="data:image/png;base64,{{acs_patient.image_1920}}" alt="Patient" style="height:130px;"/>
                    <img t-else="" class="acs_patient_image" src="/acs_hms/static/src/img/patient.png" alt="Physician" style="height:130px;"/>
                    <div class="acs_patient_name">
                        <strong><span t-esc="acs_patient.name"/></strong>
                    </div>
                    <div>
                        <span t-esc="acs_patient_relation"/>
                        <a t-if="acs_patient_relation=='Self'" t-attf-href="/my/account?redirect=/acs/radiology/patients"><i class="fa fa-pencil mx-1"/>Edit</a>
                        <a t-else="" t-attf-href="/my/family/update/#{family_member.id}?redirect=/acs/radiology/patients"><i class="fa fa-pencil mx-1"/>Edit</a>
                    </div>
                </div>
            </label>
        </div>
    </template>

    <template id="radiology_appointment_patients" name="Select Patients">
        <t t-call="website.layout">
            <div id="wrap">
                <div class="container oe_website_sale py-2">
                    <div class="row">
                        <t t-if="payment_step" t-set="confirm_warning">'Are you sure you want to Confirm Appointment and Process payment? Once redirected to Invoice page you can not change Any data. To Retray payment you can go to lab Requests and do it.'</t>
                        <t t-else="" t-set="confirm_warning">'Are you sure you want to Confirm Appointment?'</t>
                        <t t-set="cancel_warning">'Are you sure you want to cancel process?'</t>
                        <div class="col-12">
                            <t t-call="acs_radiology_website_booking.radiology_req_progress_checkout">
                                <t t-set="step" t-value="40"/>
                            </t>
                        </div>
                        
                        <form action="/acs/radiology/request/confirm" method="post" role="form" class="js_website_submit_form" enctype="multipart/form-data">
                            
                            <div class="row mt16 mb16" name="new_family_member">
                                <a href="/my/family/new?redirect=/acs/radiology/patients"><i class="fa fa-plus mx-1"/>Add New Family Member</a>
                            </div>
                            <div class="row text-center acs_location_selection">
                                <t t-call="acs_radiology_website_booking.acs_patient_card">
                                    <t t-set="acs_patient" t-value="patient"/>
                                    <t t-set="acs_patient_relation" t-value="'Self'"/>
                                </t>
                                <t t-foreach="family_members" t-as="family_member" t-if="family_members">
                                    <t t-call="acs_radiology_website_booking.acs_patient_card">
                                        <t t-set="acs_patient" t-value="family_member.related_patient_id.sudo()"/>
                                        <t t-set="acs_patient_relation" t-value="family_member.relation_id.name"/>
                                    </t>
                                </t>
                            </div>

                            <div class="col-12 text-center mt16" id="patient_note">
                                <textarea name="notes" rows="3" class="col-md-8 col-xs-12 acs_gray_border" placeholder="Patient Notes: &#10;&#10;Example: Please share report result on call."/>
                            </div>

                            <div class="row">
                                <div class="col-12 clearfix text-center mt32 mb32">
                                    <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
                                    <button type="submit" class="btn btn-default btn-primary mb32 " t-attf-onclick="return confirm(#{confirm_warning});"> 
                                        <span t-if="payment_step">Pay</span>
                                        <span t-else="">Submit</span>
                                        <span class="fa fa-long-arrow-right" />
                                    </button>
                                    <a t-attf-onclick="return confirm(#{cancel_warning});" t-attf-href="/" class="btn btn-default mb32">Cancel</a>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </t>
    </template>

    <template id="radiology_req_thank_you" name="Appointment Booked: Thank You">
        <t t-call="website.layout">
            <div id="wrap" class="oe_structure oe_empty">
                <section>
                    <div class="container">
                        <div class="row">
                            <div class="col-12">
                                <div class="mb16 mt16">
                                    <div style="text-align: center; color:green;font-size: 55px;">
                                        Thank You!
                                    </div><br/>
                                    <div style="text-align: center; color:green;font-size: 25px;">
                                        Your Radiology request has been successfully <t t-if="radiology_request.state=='accepted'">confirmed</t><t t-else="">submitted</t> , we will get back to you soon. Your reference number for this request is: <strong> <span t-field="radiology_request.name"/> </strong>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </t>
    </template>

</odoo>